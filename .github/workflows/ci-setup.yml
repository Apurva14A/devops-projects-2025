name: Code Coverage by SonarQube
on:
  push:
    branches: [flask-webapp]



jobs:

 Code_coverage:
    runs-on: [ubuntu-latest]
    environment: development

    env:
      SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}
      GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

    steps:

      # Checkout Code repository
      - name: Checkout Repository
        uses: actions/checkout@v4.2.2
        with:
          fetch-depth: 0

      - name: Official SonarQube Scan
        uses: SonarSource/sonarqube-scan-action@v5.2.0
        with:
          projectBaseDir: flask-webapp
          args: >
              -Dsonar.organization=apurva14a # For SonarQube Cloud only
              -Dsonar.projectKey=Apurva14A_devops-projects-2025 
              -Dsonar.python.coverage.reportPaths=coverage.xml
              -Dsonar.sources=lib/
              -Dsonar.verbose=true
  
     